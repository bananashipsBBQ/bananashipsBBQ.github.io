<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="24强网杯">
<meta property="og:type" content="article">
<meta property="og:title" content="24强网杯">
<meta property="og:url" content="https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/index.html">
<meta property="og:site_name" content="黄昏之时.">
<meta property="og:description" content="24强网杯">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YjdkOTI5NDVmYmMxYzIzMzMxOTEyYTlhYWM4NGIyYWNfTkVJelBnMVlpSEJUQnFsc0RFeG1ucURyNVd1dzMycXlfVG9rZW46VlZ0Y2JKUURDb2hKYzJ4MEh1YWNrdTlkblNjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MmFhMDM3OGM0YTAzZGVkMzMxZTE4ODYyNDlmM2M3YzVfN1puZEVTeGxJY3E1Z2l6MDc1c1dlWk5BQXZyaTRZcnZfVG9rZW46QXVqQWJGTzVNb2ZTeUh4elJpYWNuYUQ5bnliXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=Yzc4NjI4NWIyZDcyNTEyZjVjZjEyNzY1NTMwZWE0ZTBfTW9nYUNIeWdHZWxEamhKQmR3blB6akFBSnM5YzlpOWNfVG9rZW46RzRJbWIzUE5Xb24zNWR4MXRKemMxRHdObmViXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MjQzMDI5YzdiMzU0ODk4MTQ2ZDViNmExOWNkOWYxZjdfd2ZOQVFZZEdvaUFiM1owY094eDIxR3JCZUlpakR3N01fVG9rZW46UXRoVWJFeDZPbzQ5ZDF4ZXBSdWNIeXFCbm5jXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NzlkNjYxOGM5NTE4ZWFkMmVhYTBiOTM2OWY5YmQxMjhfN3VxRGtDcW5qU1c3QW9kTGJGVWVhcU05NGNycnBHQkFfVG9rZW46TWkweGI5cnN5b1RON0J4S0c1a2MwRHNobnJiXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDUzZjU4MmQ0MGI1ODI5M2VkMmY0YjdiOTdmMzk1MWVfU0QwdVRmMWZQalRMeW9WWlZGUng4bzd5aXFsbVRtbFVfVG9rZW46RjQ1ZWJQSkllbzN2Y2h4WlpqbGNBdFhCbjdlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MWE5NDc4NmE5YzkwYzA1ZGFlZjY5YWQ5ZjA4MDU1OWNfejNrRmFWclBIbldXTDJlRk1vWHo5TTFjUVFGdVFIbk9fVG9rZW46UkxCcGJCOWlsb0ZzSHl4TjJZcGNVZXV6bm9oXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjBkMTYwMTJjYjdhNzFiY2YzMzE4YzA5MGI1N2U2NjNfQWdnSGM1VHB5V0dkV0dHU0phV2pvbEpPSXNRdXV6T2xfVG9rZW46Sk1lSGJJNDF5b1JXdkt4RFlRT2N1TmE5bkdlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=M2IwNTJmMWQ1MmMzYWUzNWIxNTFkNzQ2NTdlOWZkNjRfZVA4NTBpa0JTM09NeFdXMEpiRnFnYzRodTJBS3lsYlRfVG9rZW46TTdEdWJJbEpVb2pRU3Z4Z09UUmNDSjdmbkVlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NzliYzNjMjI0ZDNkOGRjMjc1ZjNmMWU1MmY5MDdjYjNfUnRCVk1qNUZ6VzNhSTNVOWU2b3R1NXl5OExvQTdhQnRfVG9rZW46S2RIcWJtZFdXbzF1T1h4WHU0eWN5NHNjbnljXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OTZlN2FiNzA2YjU2YTEwODZiYTdkZDliOTc3NTNmNWFfeHdJMGFqemZZR2FZdWxVU2luVWpWT3hkMmhiQlFZVTZfVG9rZW46SWZPWGJVY05Ib3l0YmR4Qllkc2NLcHdHbm55XzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YWJhZGJkZTM3MDZjYTY0YmUyODg1NGIyMGFlOWQ2MDNfakZOOE4wNXBoZllQeVFWakJxQmxXTlM2ejR6THlIWERfVG9rZW46WWdFQWJYdDJObzV4WVp4TXc5RmNhTmQ0bm9iXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjFhYzk3YzU0MTQwYzk2MDA2YjIyOWE5ZjE3MGJkMDlfcUdBSUZuR21ycjRaZXdtUDFTTEF3U1Z0WEllWXNqTW9fVG9rZW46U3UwYmJFT3lYb2Viamd4dmVvN2Nla0pmbmNmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OTA4M2ZkMGMyYzkxNjdlYTBjYzY2NDBjNWZiNTBiNWZfWHRwQlFkc2R0YWhidGV6S1BJbmNuUHNMSlVYRHZ3YkxfVG9rZW46THJNMGJKcW9Yb2hEaHh4b3pGTmNrTE5LbmliXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2M2MDBmZWFkYmEwZDQ0ZWIyOWY2MTAwMTc2MDI4NWVfU3FUVTFac0c4dzFNRk9FcVZpNTIyS0RRbVh2eFRBdndfVG9rZW46SzhQZ2JDbjk2b2hKOER4WWs5TmM0TnBpbnlqXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YjY2NzBhN2QwODZiMmFhN2U0NGNjMDQxM2ExMjIzM2RfQTVhZHBPdk5ZOEdVcmdTb1llZDQ4N0kydGs2N2hOWGZfVG9rZW46WUpaQWJkaE5ob3hUbU94NmtEZGNSaFVibldmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YWQ0NzBjZTcyOGI2NDZhY2RhNmU1NjQ5ODA5NWUwNDdfRUR6ZDFrdDM0QzcyQXFHUXZCajVjSWJuZ1Nxc2cxMlNfVG9rZW46WDZQY2JUc0Jpb3NwUDd4VFE2ZmNWSTVHbjRmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NGQ2MzJlNzA4MzQ1YjM4NzdkZDdmODQ0YmY1ZTE0MDRfMlRvNVpKVUEwQW9aTWNEQ20wejZvM1NZRkY5VlB0ODRfVG9rZW46Q0JyaWIzRnpub0Nob3d4ckJTOWNhSW1nbjhjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NGMyNzc3MGQ0NjRlNTkxZmEzYmFmMTBhNzlkMmQ5NzJfMWNqYkVES3R0d1J4cTRrNHFGcFZZeHFJdEdGa0tSdFdfVG9rZW46RDFKcmJtNDhSb0dEazh4TlVIUGNOT3ZlbmNjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MTJmYTVhYzdhZDVkYzZhNTNlYWQ4ZjBlZmUyZTJiZGJfZmY2SGxKbmZGMVJuR1dkOUdNVjRhZmxDSm4zNkZEUDdfVG9rZW46TVFqcmJzRVdqb0hXM2p4R05lQ2NETFBYbm5nXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="og:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OGE4Nzc5ZWZhZWM1NzU2NjQ3OTUzMjliNTkyZDRmODJfd3hwUFVmSndCZHdQb1VRQWFlbG9ROVpocDdZTlZWaXZfVG9rZW46QUlXbmJ2dlFUb3huOGl4UmhkNGNCSUZIbndmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
<meta property="article:published_time" content="2024-11-04T06:26:33.000Z">
<meta property="article:modified_time" content="2024-11-11T14:05:07.607Z">
<meta property="article:author" content="bananaships">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YjdkOTI5NDVmYmMxYzIzMzMxOTEyYTlhYWM4NGIyYWNfTkVJelBnMVlpSEJUQnFsc0RFeG1ucURyNVd1dzMycXlfVG9rZW46VlZ0Y2JKUURDb2hKYzJ4MEh1YWNrdTlkblNjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>24强网杯</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2025/08/03/hello-world/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2024/10/01/SCTF-WP/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&text=24强网杯"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&is_video=false&description=24强网杯"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=24强网杯&body=Check out this article: https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&name=24强网杯&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&t=24强网杯"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">强网杯（部分）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-Master-of-DFIR-Phishing"><span class="toc-number">1.1.1.</span> <span class="toc-text">0x01 Master of DFIR - Phishing</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        24强网杯
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">bananaships</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-04T06:26:33.000Z" class="dt-published" itemprop="datePublished">2024-11-04</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Writeup/">Writeup</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="强网杯（部分）"><a href="#强网杯（部分）" class="headerlink" title="强网杯（部分）"></a>强网杯（部分）</h1><p>最牢的一场，在取证逆爽了说是。。。</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="0x01-Master-of-DFIR-Phishing"><a href="#0x01-Master-of-DFIR-Phishing" class="headerlink" title="0x01 Master of DFIR - Phishing"></a>0x01 Master of DFIR - Phishing</h3><p>总共13个问题，第一个是攻击者的邮箱，将得到的eml文件中的邮箱取md5即可</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YjdkOTI5NDVmYmMxYzIzMzMxOTEyYTlhYWM4NGIyYWNfTkVJelBnMVlpSEJUQnFsc0RFeG1ucURyNVd1dzMycXlfVG9rZW46VlZ0Y2JKUURDb2hKYzJ4MEh1YWNrdTlkblNjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第二个问题是攻击者所投放文件的密码，将eml文件中的第二段base64密文解开即可看到密码</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MmFhMDM3OGM0YTAzZGVkMzMxZTE4ODYyNDlmM2M3YzVfN1puZEVTeGxJY3E1Z2l6MDc1c1dlWk5BQXZyaTRZcnZfVG9rZW46QXVqQWJGTzVNb2ZTeUh4elJpYWNuYUQ5bnliXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第三问是攻击者所使用的攻击载荷文件windows默认的打开方式的全称，将eml文件中正文部分的内容解base64之后得到一个压缩包文件，且压缩包文件的密码即为上一问的结果 2024qwbs8 </p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=Yzc4NjI4NWIyZDcyNTEyZjVjZjEyNzY1NTMwZWE0ZTBfTW9nYUNIeWdHZWxEamhKQmR3blB6akFBSnM5YzlpOWNfVG9rZW46RzRJbWIzUE5Xb24zNWR4MXRKemMxRHdObmViXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>解开压缩包之后看到文件后缀为msc，直接搜索一下全称即可知道本题的答案为Microsoft Management Console</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MjQzMDI5YzdiMzU0ODk4MTQ2ZDViNmExOWNkOWYxZjdfd2ZOQVFZZEdvaUFiM1owY094eDIxR3JCZUlpakR3N01fVG9rZW46UXRoVWJFeDZPbzQ5ZDF4ZXBSdWNIeXFCbm5jXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第四问是攻击者所投放样本的初始执行语句在该攻击载荷文件的第几行，打开压缩包中的文件后可以得知投放样本的初始执行语句在第97行</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NzlkNjYxOGM5NTE4ZWFkMmVhYTBiOTM2OWY5YmQxMjhfN3VxRGtDcW5qU1c3QW9kTGJGVWVhcU05NGNycnBHQkFfVG9rZW46TWkweGI5cnN5b1RON0J4S0c1a2MwRHNobnJiXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第五问是经过初始执行后,攻击者所加载的第二部分载荷所使用的语言是什么，看到这一段，提取出来之后有很明显的VBS脚本特征</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDUzZjU4MmQ0MGI1ODI5M2VkMmY0YjdiOTdmMzk1MWVfU0QwdVRmMWZQalRMeW9WWlZGUng4bzd5aXFsbVRtbFVfVG9rZW46RjQ1ZWJQSkllbzN2Y2h4WlpqbGNBdFhCbjdlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>再用url解解码一下看看，所以本问的答案为VBScript</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MWE5NDc4NmE5YzkwYzA1ZGFlZjY5YWQ5ZjA4MDU1OWNfejNrRmFWclBIbldXTDJlRk1vWHo5TTFjUVFGdVFIbk9fVG9rZW46UkxCcGJCOWlsb0ZzSHl4TjJZcGNVZXV6bm9oXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第六问是攻击者所进行的第二部分载荷其将白EXE存在了什么地方，将vbs脚本解混淆之后即可知道，这部分之前在打H&amp;NCTF的有一道re题就是解这个混淆，将关键字段拿出来Dim 定义一个变量赋值之后用MsgBox 函数显示出来即可知道为&#x2F;MMC_ConsoleFile&#x2F;BinaryStorage&#x2F;Binary[@Name&#x3D;’CONSOLE_MENU’]，然后取MD5即可</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjBkMTYwMTJjYjdhNzFiY2YzMzE4YzA5MGI1N2U2NjNfQWdnSGM1VHB5V0dkV0dHU0phV2pvbEpPSXNRdXV6T2xfVG9rZW46Sk1lSGJJNDF5b1JXdkt4RFlRT2N1TmE5bkdlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第七问是攻击者使用的这个白EXE加载黑DLL的手法所对应的MITRE ATT&amp;CK ID是什么，没搜到，问一下AI就好，答案为T1574</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=M2IwNTJmMWQ1MmMzYWUzNWIxNTFkNzQ2NTdlOWZkNjRfZVA4NTBpa0JTM09NeFdXMEpiRnFnYzRodTJBS3lsYlRfVG9rZW46TTdEdWJJbEpVb2pRU3Z4Z09UUmNDSjdmbkVlXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第八问是攻击者所使用的黑DLL劫持了原始DLL的哪个函数，将文件中的二进制文件拿出来分析即可</p>
<p>框出来的三个二进制文件，倒数第一个就是题目所说的黑dll，第二个是感觉像释放出来的白exe</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NzliYzNjMjI0ZDNkOGRjMjc1ZjNmMWU1MmY5MDdjYjNfUnRCVk1qNUZ6VzNhSTNVOWU2b3R1NXl5OExvQTdhQnRfVG9rZW46S2RIcWJtZFdXbzF1T1h4WHU0eWN5NHNjbnljXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>先分析最后一个二进制文件，黑dll，逛了一圈函数，发现这个函数有动态解密的嫌疑，最后提交该函数名正确，本问答案为curl_easy_init，且加密的字节数为dwSize为136192</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OTZlN2FiNzA2YjU2YTEwODZiYTdkZDliOTc3NTNmNWFfeHdJMGFqemZZR2FZdWxVU2luVWpWT3hkMmhiQlFZVTZfVG9rZW46SWZPWGJVY05Ib3l0YmR4Qllkc2NLcHdHbm55XzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YWJhZGJkZTM3MDZjYTY0YmUyODg1NGIyMGFlOWQ2MDNfakZOOE4wNXBoZllQeVFWakJxQmxXTlM2ejR6THlIWERfVG9rZW46WWdFQWJYdDJObzV4WVp4TXc5RmNhTmQ0bm9iXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第九问攻击者所使用的黑DLL解密下一阶段载荷所使用的算法是什么，跟进上一问中动态进行解密的函数sub_10001240即可发现疑似RC4加密，故本问的答案为RC4</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjFhYzk3YzU0MTQwYzk2MDA2YjIyOWE5ZjE3MGJkMDlfcUdBSUZuR21ycjRaZXdtUDFTTEF3U1Z0WEllWXNqTW9fVG9rZW46U3UwYmJFT3lYb2Viamd4dmVvN2Nla0pmbmNmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第十问是攻击者所使用的下一阶段载荷的回连C2是什么，此处将白exe运行起来之后直接修改eip去走那个黑dll劫持函数的逻辑，用于解密RC4保护的加密内容，走完所有的解密过程之后原内容处有很明显的PE结构文件特征了</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OTA4M2ZkMGMyYzkxNjdlYTBjYzY2NDBjNWZiNTBiNWZfWHRwQlFkc2R0YWhidGV6S1BJbmNuUHNMSlVYRHZ3YkxfVG9rZW46THJNMGJKcW9Yb2hEaHh4b3pGTmNrTE5LbmliXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>此处直接使用idapython给这部分dump下来，总的字节数上面提到过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"></span><br><span class="line">start_address = <span class="number">0x5BE280B0</span>  </span><br><span class="line">size = <span class="number">136192</span>  </span><br><span class="line"></span><br><span class="line">data = idaapi.get_bytes(start_address, size)</span><br><span class="line"><span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;none&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 保存到二进制文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.bin&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ok&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>得到dump下来的文件PE文件之后继续进行逆向分析，动态调试起来之后实现了回连C2的自解密结果如下，本题答案为192.168.57.119:6000</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2M2MDBmZWFkYmEwZDQ0ZWIyOWY2MTAwMTc2MDI4NWVfU3FUVTFac0c4dzFNRk9FcVZpNTIyS0RRbVh2eFRBdndfVG9rZW46SzhQZ2JDbjk2b2hKOER4WWs5TmM0TnBpbnlqXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>第十一问是攻击者所使用最终阶段载荷所使用的加密算法是什么，这题是蒙的AES加密，因为在刚刚dump下来的这个exe中只有网络行为的连接，并没有其他内容，本题答案是AES</p>
<p>第十二问是攻击者所使用最终阶段载荷所使用的密钥的MD5是什么，这就绕不开一直苦苦寻找的那段逻辑了，卡了很久在这儿，应该是前面分析落东西了，网络行为不可能能连接成功，那么我流量包里落东西没分析了那就是，我应该去找这段shellcode</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YjY2NzBhN2QwODZiMmFhN2U0NGNjMDQxM2ExMjIzM2RfQTVhZHBPdk5ZOEdVcmdTb1llZDQ4N0kydGs2N2hOWGZfVG9rZW46WUpaQWJkaE5ob3hUbU94NmtEZGNSaFVibldmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>追踪TCP流之后将该shellcode直接dump下来</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=YWQ0NzBjZTcyOGI2NDZhY2RhNmU1NjQ5ODA5NWUwNDdfRUR6ZDFrdDM0QzcyQXFHUXZCajVjSWJuZ1Nxc2cxMlNfVG9rZW46WDZQY2JUc0Jpb3NwUDd4VFE2ZmNWSTVHbjRmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>那么现在shellcode有了，我缺一个主动调用这个shellcode的exe主体，直接搓一个主动调用一下该段shellcode</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NGQ2MzJlNzA4MzQ1YjM4NzdkZDdmODQ0YmY1ZTE0MDRfMlRvNVpKVUEwQW9aTWNEQ20wejZvM1NZRkY5VlB0ODRfVG9rZW46Q0JyaWIzRnpub0Nob3d4ckJTOWNhSW1nbjhjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>然后使用ida动调这个刚写的exe，跟到shellcode的逻辑之后，shift+f12直接看字符串就能看到key</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=NGMyNzc3MGQ0NjRlNTkxZmEzYmFmMTBhNzlkMmQ5NzJfMWNqYkVES3R0d1J4cTRrNHFGcFZZeHFJdEdGa0tSdFdfVG9rZW46RDFKcmJtNDhSb0dEazh4TlVIUGNOT3ZlbmNjXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>那么该问题的答案既是pJB&#96;-v)t^ZAsP$|r的MD5值</p>
<p>第十三问是攻击者使用了什么家族的C2，貌似找数据包的时候看到了它的UA，本题答案为orcaC2</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=MTJmYTVhYzdhZDVkYzZhNTNlYWQ4ZjBlZmUyZTJiZGJfZmY2SGxKbmZGMVJuR1dkOUdNVjRhZmxDSm4zNkZEUDdfVG9rZW46TVFqcmJzRVdqb0hXM2p4R05lQ2NETFBYbm5nXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>
<p>最后得到flag</p>
<p><img src="https://cwnc7d4io7.feishu.cn/space/api/box/stream/download/asynccode/?code=OGE4Nzc5ZWZhZWM1NzU2NjQ3OTUzMjliNTkyZDRmODJfd3hwUFVmSndCZHdQb1VRQWFlbG9ROVpocDdZTlZWaXZfVG9rZW46QUlXbmJ2dlFUb3huOGl4UmhkNGNCSUZIbndmXzE3MzA3MDE4MTM6MTczMDcwNTQxM19WNA" alt="img"></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">强网杯（部分）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-Master-of-DFIR-Phishing"><span class="toc-number">1.1.1.</span> <span class="toc-text">0x01 Master of DFIR - Phishing</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&text=24强网杯"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&is_video=false&description=24强网杯"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=24强网杯&body=Check out this article: https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&title=24强网杯"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&name=24强网杯&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://bananashipsbbq.github.io/2024/11/04/24%E5%BC%BA%E7%BD%91%E6%9D%AF/&t=24强网杯"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    bananaships
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
